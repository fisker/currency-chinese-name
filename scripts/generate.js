import writePrettierFile from 'write-prettier-file'
import getData from './get-data.js'

const PROJECT_ROOT = new URL('../', import.meta.url)
const SCRIPT_FILE = import.meta.url.slice(PROJECT_ROOT.href.length)

const currencies = await getData()

const head = `
/*
DO NOT EDIT THIS FILE

Auto generated by script \`../${SCRIPT_FILE}\`
*/
`

await writePrettierFile(
  new URL('./src/raw-currency-data.js', PROJECT_ROOT),
  `
    ${head}

    export default ${JSON.stringify(
      currencies.map(({code, name}) => `${code}${name}`).join(','),
    )}
  `,
  {parser: 'meriyah'},
)
await writePrettierFile(
  new URL('./src/currencies.js', PROJECT_ROOT),
  `
    ${head}

    export default ${JSON.stringify(currencies)}
  `,
  {parser: 'meriyah'},
)
